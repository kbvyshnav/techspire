<!DOCTYPE html>
<html>
  <head>
    <title>CHAT BOXXX</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400&display=swap">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <style>
       * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;

      } 

      body{ 
        background-color: red; 
        
      }

   .chatbot{    
            
        /* right: 10px;
        bottom: 50px; */
        width: 380px;
        height: 550px;
        overflow: hidden;
        background-color: white ;  
        border-radius: 15px;           
      }

      .chatbot header{
        background-color: rgb(29, 29, 29); ;
        color:white;
        padding: 8px;
        text-align: center;
        
      }
      
      .chatbot .chatbox{
        height: 250px;
        overflow-y: auto;
        padding: 30px 20px 70px;
      }
      
      .chatbox  .chat{
        display: flex;     
      }

      .chatbox .outgoing {
        justify-content: flex-end;
        margin: 25px 0; /* space b/w incoming and outgoing msgs */
        position: relative; /* Add this line */
      }
      
       .chatbox .incoming {
        justify-content: flex-end;
        margin: 25px 0; /* space b/w incoming and outgoing msgs */
        position: relative; /* Add this line */
      }


      .chatbox .outgoing .time-outgoing {
        position: absolute;
        bottom: -20px; /* Adjust the position as needed */
        right: 0;
        font-size: 12px;
        color: #777;
      }

      .chatbox .chat p {
          color: white;
          max-width: 75%;
          padding: 12px 16px;
          border-radius: 10px 10px 0 10px;
          background-color: black;
          font-size: 0.95rem;
          overflow-wrap: break-word; 
          white-space: pre-line; 
      }

       
      .chatbox .incoming p{
        color:rgb(29, 29, 29);
        background: rgb(231, 231, 231);
        border-radius: 10px 10px 10px 0;
      }

      .chatbot .chat-input{
        position: absolute;
        bottom:0;
        width: 100%;
        display:flex;
        gap: 5px;
        background-color: white;
        padding: 5px 20;
        border-top: 1px solid #ccc;       
      }

      .chat-input textarea{ 
        height: 55px;     
        width: 82%;
        border:none;
        outline: none;
        font-size: 0.95rem;
        resize: none;
        padding: 16px 15px 16px 15px;
        overflow-y: auto;
      }

      
#attachment-icon {
    align-self: flex-end;
    height: 55px;
    line-height: 55px;
    color: black;
    font-size: 1.35rem;
    cursor: pointer;
    visibility: visible; 
}


#send-btn {
    align-self: flex-end;
    height: 55px;
    line-height: 55px;
    color: black;
    font-size: 2rem;
    cursor: pointer;
    visibility: hidden; 
}


#message-input:valid ~ #send-btn {
    visibility: visible;
}

 
      .chat-input textarea:valid ~ span {
        visibility: visible;
      }
      

      .time-incoming {
        color: #777;
        font-size: 12px; 
      }
      
      .incoming-user-name{
        font-weight: bold;
      }

    </style>
  </head>
  <body>

    <div class="chatbot">
        <header>
          <h2>ChatboXT</h2>
        </header>
      <ul class="chatbox">
        {% for msg in messages %}
        {% if msg.user_id == request.user %} 
        <!-- Incoming message------------------------------ -->
        <span class="incoming-user-name">{{msg.user_id.username}}</span>
          <li class="chat incoming">          
           <p> {{msg.msg}}{{msg.status}}
           </p>        
          </li>
        <span class="time-incoming">{{msg.updated_on | date:"h:i A - D,dS M y  "}}</span>
        {% else %}

        <!-- Outgoing message------------------------------ -->
        <li class="chat outgoing">              
          <p>{{msg.msg}} {{msg.status}}
          </p>
          <span class="time-outgoing">{{msg.updated_on | date:"h:i A - D,dS M y  "}}</span>
         </li>
        

      </ul>
      {% endif %}
      {% endfor %}
      <div class="chat-input">
        <textarea id="message-input" placeholder="Enter a message..." required></textarea>
        <span id="attachment-icon" class="material-symbols-outlined">attach_file</span>

        <span id="send-btn" class="material-symbols-outlined">send</span>
      </div>
    </div>

    <script>
      
   // Text-area auto resizing...................
   const textarea = document.getElementById("message-input");

   textarea.addEventListener("input", function () {
     this.style.height = "auto";
     this.style.height = Math.min(this.scrollHeight, 180) + "px";
   });
</script>

    

  </body>
</html>