
{% extends "cAdmin/baseUI.html" %}
{% load static%}
{% block body %}

<style>
  

 .exit-symbol {
 position: absolute;
 top: 10px;
 right: 24px;
 font-size: 30px;
 cursor: pointer;
}

.log {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
background-color: #fff;
display: none;
border-radius: 20px;
box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
width: 1000px;
height: 650px;
z-index: 9995;
}
.log .closeboxlog {
    position:absolute;
    color: #0a0a0a;
    float: right;
    font-size: 30px;
    top: 10px;
    right:45px;
     cursor: pointer;
     z-index: 9996 ;
}
.log .popup-body {

   height: 100%;
   width: 100%;
  overflow-y: auto ;
}

.projection{
  z-index: 99991;
}
.btn {
    appearance: none;
      -webkit-appearance: none;
    font-family: sans-serif;
    cursor: pointer;
    padding: 12px;
    min-width: 100px;
    border: 0px;
      -webkit-transition: background-color 100ms linear;
      -ms-transition: background-color 100ms linear;
       transition: background-color 100ms linear;
    float: left;
  }
.edit {
  background: #1181dd;
  margin-right: 60px;
  color: #ffffff;
}
.delete {
  background: #e20b0b;
  
  color: #ffffff;
}
.edit:hover {
  background: #069ff8;
  color: #ffffff;
}
  .view {
  text-decoration: none;
  position: relative;
  border: none;
  font-size: 14px;
  font-family: inherit;
  color: #fff;
  width: 5em;
  height: 2em;
  line-height: 2em;
  text-align: center;
  background: linear-gradient(90deg,#03a9f4,#f441a5,#ffeb3b,#03a9f4);
  background-size: 300%;
  border-radius: 30px;
  z-index: 1;
}

.view:hover {
  animation: ani 8s linear infinite;
  border: none;
}

@keyframes ani {
  0% {
    background-position: 0%;
  }

  100% {
    background-position: 400%;
  }
}

.box {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #fff;
  display: none;
  border-radius: 20px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
  padding-bottom: 59px;
  width: 1000px;
  height: 600px;
  z-index: 999;
}

.popup-header {
  background-color: #668aaf; 
  color: white; /* White font color */
  text-align: center;
  border-radius: 20px 0 0 0; /* Rounded corners only at the top */
  font-size: 1.3rem;
  padding: 0 5px; /* Remove padding at the top and add padding to the sides */
  height: 110px; /* Adjust the height as needed */
  line-height: 40px; /* Vertically center the content */
  position: sticky;
  top: 0;
}


.popup-header p {
  margin: 0; /* Remove the top and bottom margin for the paragraph */
}

.ticket-id {
  text-align: left;
  font-size: 2rem;
  padding: 15px 25px 0; /* Adjust padding to move content higher */
  margin-top: -10px; /* Add negative margin to move the entire block upwards */
}

.panel-label {
    background-color: white; /* Background color */
    color: black; /* Text color */
    padding: 0px 15px 5px; /* Padding for spacing (adjust the top padding) */
    border-radius: 25px; /* Rounded corners */
    font-size: 24px;
}

.status-label {
    background-color: #7863b6; 
    color: white; 
    padding: 5px 15px; 
    border-radius: 25px; 
    font-size: 14px;
    margin-top: 20px; 
    margin-left: 0px; 
    border: 1px solid white; 
}
 {% comment %} .status-label::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url("data:image/svg+xml,%3Csvg width='80' height='50' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='0' y='44' font-family='Poppins' font-size='20' fill='rgba(155, 179, 202, 010)'%3EINBOX%3C/text%3E%3C/svg%3E") ;
      background-size: contain;
      z-index: -5;
    }


    .status-label span {
      position: relative;
      z-index: 1;
    }

    .status-label svg {
      vertical-align: left; 
      margin-right: 2px; 
      opacity: 1; 
    } {% endcomment %}


.header-buttons {
  display: flex;
  gap: 10px;
  margin-left: 755px;
  margin-top:-30px /* Adjust the left margin as needed */
  /* Add top margin to push buttons down slightly */
}

.header-button {
  background-color: white;
  color: black;
  border: none;
  padding: 5px 10px;
  border-radius: 5px;
  cursor: pointer;
}

.header-button:hover {
  background-color: #c6c2f0;
}

.ticket-details-box {
  background-color: #f3f3f3; /* Off-white shaded background color */
  padding: 20px; /* Add padding for spacing */
  display: flex;
  flex-direction: column;
  align-items: left; /* Center horizontally */
  text-align: left; /* Center text horizontally */
  margin: 0 auto; /* Center the box horizontally */
  max-width: 900px; /* Set a maximum width */
}


.ticket-details {
  font-size: 1rem;
  line-height: 2.5;
  display: flex;
  flex-direction: column;
  align-items: flex-start; /* Align content to the top-left */
}

.ticket-details p {
  margin: 0; /* Remove margin for paragraphs inside the ticket-details box */
}

.ticket-details span {
  text-align: center; /* Center the text in the span elements */
}

.gap {
  height: 20px; /* Adjust the height of the gap as needed */
}

.additional-details-box {
  background-color: #f3f3f3; /* Off-white shaded background color */
  border-radius: 20px;
  padding: 25px; /* Add padding for spacing */
  display: flex;
  flex-direction: column;
  align-items: left; /* Center horizontally */
  text-align: left; /* Center text horizontally */
   margin: 0 auto; /* Center the box horizontally */
  max-width: 900px; /* Set a maximum width */
}


.additional-details p {
  margin: 10px 0; /* Add margin for spacing between paragraphs */
}

/* Action box CSS */
.action-box {
  background-color: #f3f3f3; /* Off-white shaded background color */
  padding: 15px; /* Adjust padding for spacing */
  display: flex;
  flex-direction: column;
  align-items: left; /* Center horizontally */
  text-align: left; /* Center text horizontally */
  margin: 0 auto; /* Center the box horizontally */
  max-width: 900px; /* Set a maximum width */
  height: 500px; /* Increase the height */
  border-radius: 20px; /* Rounded corners only at the top */
}


.chat-frame {
position: absolute;
top: 50%;
left: 75%;
 transform: translate(-50%, -50%);
 background-color: transparent; 
display: none;
border-radius: 20px;
 /* box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);  */
width: 400px;
height: 650px;
z-index: 9998;
}
.chat-frame .chat-close{
    display: none;
    position:absolute;
    color: #0a0a0a;
    float: right;
    font-size: 30px;
    top: 30px;
    left:445px;
     cursor: pointer;
     z-index: 9999 ;
}

.child {
  display: none;
}


.view:before {
  content: '';
  position: absolute;
  top: -5px;
  left: -5px;
  right: -5px;
  bottom: -5px;
  z-index: -1;
  background: linear-gradient(90deg,#03a9f4,#f441a5,#ffeb3b,#03a9f4);
  background-size: 400%;
  border-radius: 35px;
  transition: 1s;
  
}

.view:hover::before {
  filter: blur(20px);
}

.view:active {
  background: linear-gradient(32deg,#03a9f4,#f441a5,#ffeb3b,#03a9f4);
}
  #open {
    display: inline-block;
  border-radius: 20px;
  background-color: #7948d4;
  font-weight: bold;
  color: #ffffff;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
}


#assigndev {
  text-align: center; /* Center-align the contents of the <p> element */
}

#assigndev button  {
      color: white;
      background-color:#1aa3ff;
      padding: 4px;
      border-radius: 5px;
      width:90px;
      border: none;
      cursor: pointer; 
    font-size: 14px; 
    margin-left: -37px
    
    }

#assigndev button:hover {
    background-color: lightblue; /* Change color on hover */
}

.rejects {
  background-color: #dd1f11; /* Blue color */
  color: #ffffff;
  padding: 5px 20px; /* Adjust padding for oval shape */
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block; /* Ensure the button is not displayed as a block element */
  border-radius:10px;
  box-shadow:3px 3px 3px 1px grey;
  margin-left: -52px;
}
.assigntester  {
      color: white;
      background-color:  #0099ff;
      padding: 4px;
      border-radius: 5px;
      width:136 px;
      border: none;
      cursor: pointer; 
    font-size: 14px; 
    margin:10px;
    
    }
.assigntester:hover {
  background-color:  #66c2ff; 
}

.reassigntester-btn {
  /* Style for the assign tester button */
  display: none;
  background-color: #d8e4eb; /* Blue color */
  color: rgb(0, 0, 0);
  padding: 8px; 
  text-decoration: none;
  font-size: 15px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block; 
}
.reassigntester-btn:hover{
background-color: #a1bace;
}

/* Style for the "Proceed" button */
#dev_cht_btn {
  background-color: #1181dd; 
  color: #ffffff;
  padding: 5px 20px; 
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block;
  border-radius:10px;
  box-shadow:3px 3px 3px 1px grey;
}



#rejectdev {
  text-align: center; /* Center-align the contents of the <p> element */
  
}

#rejectdev button {
  /* Style for the oval-shaped button */
  background-color: red; /* Blue color */
  color: #ffffff;
  padding: 5px 20px; /* Adjust padding for oval shape */
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block; /* Ensure the button is not displayed as a block element */
  float:left;
 border-radius:10px;
  box-shadow:3px 3px 3px 1px grey;
}

#table-datas {
        border-collapse: collapse; /* This removes the default spacing between table cells */
        width: 100%;
        cursor:pointer;
    }

    #table-datas tbody tr {
        border-bottom: 1px solid #dddddd; /* Add a bottom border to tbody rows */
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.2); /* Add a small shadow to the bottom of each row */
        border-right: none; /* Hide the right vertical border */       
        /*border-left: 6px solid #42A8D5;*/
    }

    #table-datas th, #table-datas td {
        text-align: left;
        {% comment %} padding: 8px; {% endcomment %}
    }

   .exclude-hover td {
  padding: 10px; /* Adjust the padding as needed */
}

  .new-label {
            background-color: #FF5733; /* Background color */
            color: white; /* Text color */
            padding: 0px 8px; /* Padding for spacing */
            border-radius: 13px; /* Rounded corners */
            font-size: 12px;
        }
 #dev_btn {
  text-align: center; /* Center-align the contents of the <p> element */
}

#dev_btn {
  /* Style for the oval-shaped button */
  background-color: #1181dd; /* Blue color */
  color: #ffffff;
  padding: 5px 20px; /* Adjust padding for oval shape */
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block; /* Ensure the button is not displayed as a block element */
  border-radius:10px;
  box-shadow:3px 3px 3px 1px grey;
}

.flex-ticketbox {
            display: flex;
            justify-content: space-around;
            
            
        }
           .flex-item1 {          
            width: 100px;
            height: 50px;
            margin: 1px;
            text-align: left;
            font-size: 16px;
            font-weight:bold;                      
           }

          
        .flex-item2 {
    width: 100px;
    height: 50px;
    margin: 1px;
    text-align: right;
    font-size: 16px;
    margin-left: 150px; 
}


       .flex-item3 {
    width: 400px;
    height: 50px;
    margin: 1px;
    text-align: left;
    font-size: 16px;
    margin-left: 80px; 
}

/*....................Remarks..................... box*/
.form__group {
  margin-left: 3px;
  position: relative;
  padding: 20px 0 0;
  width: 100%;
  max-width: 650px;
  margin: 10px;
}

.form__field {
  
  width: 100%;
  border: none;
  border-bottom: 2px solid #9b9b9b;
  outline: 0;
  font-size: 17px;
  color: black;
  padding: 7px 0;
  background: transparent;
  transition: border-color 0.2s;
}

.form__field::placeholder {
  color: transparent;
}

.form__field:placeholder-shown ~ .form__label {
  font-size: 17px;
  cursor: text;
  top: 20px;
}

.form__label {
  position: absolute;
  top: 0;
  display: block;
  transition: 0.2s;
  font-size: 17px;
  color: black;
  pointer-events: none;
}

.form__field:focus {
  padding-bottom: 6px;
  font-weight: 400;
  border-width: 3px;
  border-image: linear-gradient(to right, #116399, #38caef);
  border-image-slice: 1;
}

.form__field:focus ~ .form__label {
  position: absolute;
  top: 0;
  display: block;
  transition: 0.2s;
  font-size: 17px;
  color: black;
  font-weight: 700;
}

/* reset input */
.form__field:required, .form__field:invalid {
  box-shadow: none;
}

    .custom-p {
        color: #c653c6;
        display: inline; 
    }

    .thead-tstrheader {
  background-color: #7863b6;
  color: white;
  padding-left: 17px;
  width: 200px; 
  height: 50px;
  text-align: center;
  font-size: 16px;
  border-radius: 10px 10px 0 0;
}
 
.reject-button {
      color: white;
      background-color: red;
      padding: 4px;
      border-radius: 5px;
      width:162px;
      border: none;
      cursor: pointer; 
    font-size: 14px; 
    margin:10px;
    
    }
.reject-button:hover {
  background-color: lightcoral; 
}

#qryclse {
      color: white;
      background-color: red;
      padding: 4px;
      border-radius: 5px;
      width:162px;
      border: none;
      cursor: pointer; 
    font-size: 14px; 
    margin:10px;
    
    }
#qryclse:hover {
  background-color: lightcoral; 
}


    </style>



<ul class="box-info">
  <a href = "{% url 'admin_home' company_id prev_date to_date keyword flag|default:'0' %}"><li style="background-color:  #f0eef7; 	padding: 24px;  border-radius: 20px; display: flex;align-items: center;  grid-gap: 24px;  outline: none;  border-color: #7a7aff;  box-shadow: 0 0 5px #7a7aff;">
		<i class='bx bxs-calendar-check' ></i>
		<span class="text">
			<h3 id="Requests">{{tickets.count}}</h3>
			<p>Inbox</p>
		</span>
	</li>
</a>

<a href="{% url 'admin_inprogress' company_id prev_date to_date keyword flag|default:'0' %}">
	<li >
		<i class='bx bx-hourglass'></i>
		<span class="text">
			<h3 id="Pending" >{{inprogress}}</h3>
			<p>In progress</p>
		</span>
	</li></a>


  <a href = "{% url 'admin_forwarded' company_id prev_date to_date keyword flag|default:'0' %}">
	<li>
		<i class='bx bx-pause-circle'></i>
		<span class="text">
			<h3 id="hold" >{{fwd}}</h3>
			<p>Forwarded</p>
		</span>
	</li></a>

  
  <a href = "{% url 'admin_closed' company_id prev_date to_date keyword flag|default:'0' %}">
	<li><i class='bx bx-window-close'></i>
		<span class="text">
			<h3 id="Closed">{{closed}}</h3>
			<p>Closed</p>
		</span>
	</li></a>
</ul>
  
  <div class="table-data">
      <div class="order">
          <div class="head">
            <h3>Tickets 
                  <p class="custom-p">INBOX</p>
            </h3>
           
          
        </div>
         <table id="table-datas">
            <thead class="thead-tstrheader">
                <tr>

                    <td>Ticket ID</td>
                    <!-- <td>Requester</th> -->
                    <td>Client</td>
                    <td> </td>
                    <td>Subject</td>
                     <td>Issue Date</td> 
                     <td></td> 
                     <td></td> 
                    <!-- <th>Date Of Expiry</th> -->
                    
                    <!-- <th>View Ticket</th>   -->
                </tr>
                
            </thead>
        
        <tbody> 
        
          {% for ticket in tickets %}
          <tr data-ticket="{{ ticket.ticket_no }}"  id="{{ticket.ticket_no}}" onclick="javascript:actionselect('{{ticket.ticket_no}}'); event.stopPropagation();"><td>{{ticket.ticket_no}}{% if ticket.status == 'TP' %}<span class="new-label">New</span>
            
            {%endif%}</td>
          
          {%comment%} <td>{{ticket.updated_by}}</td> {%endcomment%}
          <td>{{ticket.client}}</td>
          {% if ticket.file.url is not None%}
          <td class="projection">

                    <a href="{{ ticket.file.url }}" target="_blank"> <button class="attachment-icon" title="open files" onclick="event.stopPropagation();" ></button></a>

                    <input type="Hidden" id = 'tfile{{ticket.ticket_no}}' value="{{ticket.file.url}}">
                    </td>

                    {% else %}
                    <td> </td>
                    <input type="Hidden" id = 'tfile{{ticket.ticket_no}}' value="none">
                    {% endif %}
                  
          
          <td>{{ticket.subject}}</td>
           
             <td style="text-align: left;">{{ticket.issued_on | date:"d-m-y"}}</td>
         <td>
    <div class="chat-container">
        <i id="chaticon{{ticket.ticket_no}}" class='bx bxs-message-alt-dots chat-icon' title="Open Chat"
           onclick="document.getElementById('updtid').value='{{ticket.ticket_no}}'; chatfn(); event.stopPropagation();">
        </i>
        {% if ticket.notification %}  <span class="notification-dot"></span> {%endif%}
    </div>
</td>



        <td>
            <button class="log-icon" title="Open log"  onclick="javascript:document.getElementById('updtid').value='{{ticket.ticket_no}}'; outlook(); event.stopPropagation();"></button>  

             
         </td>
         
         <!-- <td style="text-align: right;"><button onclick="javascript:outlook('{{ticket.ticket_no}}')"></button></td>-->
          <td><input type="Hidden" id = 'tdes{{ticket.ticket_no}}' value="{{ticket.desc}}">
          <input type="Hidden" id = 'tsub{{ticket.ticket_no}}' value="{{ticket.subject}}">
          <input type="Hidden" id = 'texp{{ticket.ticket_no}}' value="{{ticket.expiry}}">
          <input type="Hidden" id = 'tmaker{{ticket.ticket_no}}' value="{{ticket.maker.username}}">

         
          <input type="Hidden" id = 'ttester{{ticket.ticket_no}}' value="{{ticket.tester_id}}">
          <input type="Hidden" id = 'tpriority{{ticket.ticket_no}}' value="{{ticket.priority}}">
          <input type="Hidden" id = 'tcli{{ticket.ticket_no}}' value="{{ticket.client}}">
          <input type="Hidden" id = 'tissue{{ticket.ticket_no}}' value="{{ticket.issued_on  | date:'d-m-Y'  }}">
         

          

          <input type="Hidden" id = 'tdevs' value="{{devs.client}}">
          <input type="Hidden" id = 'tester' value="{{devs.tester_id}}">
          <input type="Hidden" id = 'tdevid{{ticket.ticket_no}}' value="{{ticket.dev_id}}">
          
          <input type="Hidden" id = 'tstatus{{ticket.ticket_no}}' value="{{ticket.status}}">
        </td>
          {%empty%}
          <td style="text-align: center; color: red;">NO ENTRIES!</td>

      
        {% endfor %}
        <input type="Hidden" id = 'updtid' value="">
        <input type="hidden" id="page_id" value="P">
        
          </tr>
        </tbody>
      </table>
      </div>
    </div>

<!-----------------------------------TICKET DETAILS BOX-------------------------------------------------->

      <div class="box" name="tcktpopup" id="tcktpopup" style="overflow-y: auto;" >
        <div>
            <div class="popup-header">
            
          <!-- <span class="panel-label">Inbox</span>  -->
                      <span class="exit-symbol" onclick="javascript:closeBox();" title="Close">&times;</span>

            <div class="ticket-id">Ticket <span id="ticket_no"></span>
                <div><span class="status-label" id="wrdstat">INBOX</span></div>
                

              <div class="header-buttons">
                <button class="header-button" onclick="javascript: chatfn();">Chat</button>
                <button class="header-button" onclick="javascript: outlook();">Outlook</button>

                
              </div>
            </div>  
          </div>
          
          
           <hr>

            <body>
                  <br>
                
                <div class="ticket-details-box">
                  <div class="ticket-details">

                                   <div class="flex-ticketbox">
                                           <div class="flex-item1">Client</div>
                                           <div class="flex-item2">:</div>
                                           <div class="flex-item3"><span id="tcli"></span></div>                                         
                                    </div>

                                    <div class="flex-ticketbox">
                                <div class="flex-item1">Maker</div>
                                <div class="flex-item2">:</div>
                                <div class="flex-item3"><span id="maker"></span></div>
                                 
                                     </div>

                         
                        <div class="flex-ticketbox">
                                <div class="flex-item1">Priority</div>
                                <div class="flex-item2">:</div>
                                <div class="flex-item3"><span id="tpri"></span></div>
                                 
                         </div>


                        
                         
                         <div class="flex-ticketbox">
                                <div class="flex-item1">Issue Date</div>
                                <div class="flex-item2">:</div>
                                <div class="flex-item3"><span id="tdate"></span></div>
                                 
                         </div>

                    
                  </div>
                </div>

              <!--  gap -->
              <div class="gap"></div>

              <div class="additional-details-box">
                  <div class="additional-details">
                      <p><b>Subject :</b></p>
                      <p id="tsub"></p>
                      <p><b>File :</b></p>
                      <p><a id="tfile"></a></p>
                      <p><b>Description :</b></p>
                      <textarea input type="text" disabled id="tdesc" rows="6" cols="100"
                          style="border: none; color: #342E37; font-family: poppins, sans-serif; font-size: 16px;"></textarea>
                  </div>
               </div>

                
                  
                       <!--  gap -->
              <div class="gap"></div>
             </body>
            </table>         
         </div>
                  <!----------------- Actions box ---------------------------------------------------------------------------------->
                  
                  <div class="action-box">
                   
                      

                          <br>
                    <div id = 'devasgn' name = 'devasgn' class="child"> <!-- For assign a developer for ticket For : TP -->
                    
                    <form name="devasgn_form" id="devasgn_form" action="{% url 'assignTicket' %}" onsubmit="javascript: return assigndev();" method="post" enctype="multipart/form-data">      
                      {% csrf_token %}
                    <table>
                      <div class="form__group field">
                        <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                        <label for="name" class="form__label">Comments...</label>
                      </div><br>

                
                
               <br>

                    <tr>
  <td><b>Select developer &nbsp;</b></td>
  <td>
    <select onchange="getTicketCount(this)" id="devassign" name="devassign"
            style="width:150px; height:30px; border-radius:10px;" required>  
      <option selected value="">------Select----------</option>
      {% for dev in devs|dictsort:"username" %}
        <option value="{{ dev.username }}" id="{{ dev.id }}" data-ticket-count="{{ dev.ticket_count }}">
          {{ dev.username }}
        </option>
      {% endfor %}
    </select><span style="color: rgb(47, 56, 184);">&nbsp;Assigned Ticket Count:</span> <span id="ticketCountDisplay" style="color: red;">--</span>
  </td>
  <td>
    <div class="showcase-box">
      {% for dev in devs %}
    <div class="dev-item"><span>{{dev.username}}</span> <b>{{dev.ticket_count}}</b></div>
    {%endfor%}
    </div>
  </td>
</tr>

                      <tr ><td id="assigndev"><button  class="rejects">Assign</button></td> <td><input type="checkbox" id="mail_reminder_flag" name = 'mail_reminder_flag' checked > send reminder mail </td> </tr>
                      
                      
                      </table>
                    </form>
                  </div>

      


                  <div id = 'tstr_slct' class="child"> <!-- for status : PP -->
                    <!-- After Test completetion tester forwarded to admin to Accept -->

                    <form id="tstr_slct_form" name="tstr_slct_form" method="post" action="{% url 'tstr_ops' %}" enctype="multipart/form-data" >
                    {%csrf_token%}
                    <table>
                      <div class="form__group field">
                        <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                        <label for="name" class="form__label">Comments...</label><br>

                    <div class="rmk_files_div">
                      <input type="file" id="rmk_files" name="rmk_files" class="green-input">
                    </div>

                </div>
                    <tr  >
                        <td>
                          
                          <span> Current Tester: &nbsp;
                            <input type="hidden" id="cur_tstr_label_val" value="">
                            <b id = 'cur_tstr_label' > </b> &nbsp;&nbsp;&nbsp; </span><br>
                          <span id = 'tstr_label' > Select  tester &nbsp;: </span> &nbsp;&nbsp;&nbsp;
                          <select name="tstr_drpdwn" id="tstr_drpdwn" name = "tstr_drpdwn" style="width:100px; height:30px; border-radius:10px;" placeholder= "select" required>
                          
                            <!-- <option value="*" selected>------select--------</option> -->
                            {% for tester in testers|dictsort:"username" %}
                              <option value="{{ tester}}"  >
                                {{ tester }}
                              </option>
                            {% endfor %}
                            
                          </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          <span style="display: -webkit-inline-box;"><button type="button"  class= "reassigntester-btn"  id = 'retest' onclick="javascript:tstrops(flag=1);" >Submit</button> </span>
                          <br><br>
                          <span style="display: -webkit-inline-box;" ><button type="button" class= "assigntester"  id = 'tstr_btn' onclick="javascript: tstrops(flag=0)"> Forward to developer</button> </span>
                        </td>
                    </tr>
                    </table>
                    </form>
                  </div>  
                  
                  
                  
                 <div id = 'dev_slct' class="child"> <!-- for status : PP -->
                  <form id = 'dev_slct_form' name = 'dev_slct_form' method="post" action="{% url 'devops' %}" enctype="multipart/form-data">
                    {%csrf_token%}
                  <!-- After Test completetion tester forwarded to admin to Accept -->
                  <table>
								
                    <div class="form__group field">
                      <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                      <label for="name" class="form__label">Comments...</label><br>

                      <div id = 'rmk_files_div' >
                        <input type="file" id = 'rmk_files' name = 'rmk_files'> 
                      </div>


              </div>
					   
                  <tr >
                      <td>
                        
                                             

                          <button type="button"  id = 'dev_btn' onclick="devops('dev_slct_form')"> Forward to client</button> 
                      </td>
                  </tr>
                  </table>
                  </form>
                </div> 

                <div id = 'dev_cht' class="child"> <!-- For chat accept ; changes status DH: TH-->
                  <form id = 'dev_cht_form' name = 'dev_cht_form' method="post" action="{% url 'devops' %}" enctype="multipart/form-data" >
                    {%csrf_token%}
                  <table>
                      <tr>
                          
                    <div class="form__group  field">
                      <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                      <label for="name" class="form__label">Comments...</label><br>

                      <div id = 'rmk_files_div' >
                        <input type="file" id = 'rmk_files' name = 'rmk_files'> 
                      </div>


              </div>
                  
      
                    <td id="dev_cht_desc" >Developer has requested a query to client in chat. </td>
                       
                       <td>
                        <select name="dev_drpdwn" id="dev_drpdwn" style="width:100px; height:30px; border-radius:10px;" placeholder= "select" required>

                       {% for dev in devs %}
                        <option value="{{dev}}"  >
                          {{ dev}}
                        </option>
                      {% endfor %}
                    </select>

            <button type="button" id="dev_cht_btn" onclick="javascript:devops('dev_cht_form');">Forward</button>
            <button type="button" id="qryclse"  onclick="queryclose();">close query</button>

                          
                      </td>
                  </tr>
                  </table>
                  </form>
                </div> 



                   <div id = 'tstr_qry' class="child"> <!-- For Developer related query -->
                    <form id = 'tstr_qry_form' name = 'tstr_qry_form' method="post" action="{% url 'devops' %}" enctype="multipart/form-data">
                      {%csrf_token%}
                  <table>
                    <div class="form__group field">
                      <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                      <label for="name" class="form__label">Comments...</label><br>

                      <div id = 'rmk_files_div' >
                        <input type="file" id = 'rmk_files' name = 'rmk_files'> 
                      </div>

              </div>
                  <tr >
                    <td id="dev_cht_desc" > Tester has reported in chat </td>
                      <td>
                          <button type="button"  id = 'dev_cht_btn' onclick="devops('tstr_qry_form')" > Proceed</button> 
                          
                      </td>
                  </tr>
                  </table>
                    </form>
                </div> 

                
                <div id = 'tckt_clse' class="child"> <!-- for status : PC  and closing the ticket-->
                  <!-- After Test completetion tester forwarded to admin to Accept -->
                  <form id = 'tckt_clse_form' name='tckt_clse_form' method="post" action="{% url 'devops' %}" enctype="multipart/form-data">
                    {%csrf_token%}
                  <table>
                    <div class="form__group field">
                      <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
																														

                      <label for="name" class="form__label">Comments...</label>

                     </div>
                  <tr  >
                      <td>
                        
                          <button type="button"  id = 'dev_btn' onclick="devops('tckt_clse_form')"> Ticket Close </button> 
                      </td>
                  </tr>
                  </table>
                  </form>
                </div> 



                <div id = 'tckt_rjct'  class="child"> <!-- for status : TP -->
                  <!-- For reject the ticket -->
                  <form id = 'tckt_rjct_form' name = 'tckt_rjct_form' method="post" action="{% url 'devops' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                  <table>
                    <div class="form__group field">
                      <input type="input"  id="remarks" name="remarks" class="form__field" placeholder="Name">
                      <label for="name" class="form__label">Comments...</label><br>

                      <div id = 'rmk_files_div' >
                        <input type="file" id = 'rmk_files' name = 'rmk_files'> 
                      </div>

              </div>
                  <tr class="exclude-hover" >

                      <td>                       
                          <button type="button"  id = 'dev_btn' onclick="devops('tckt_rjct_form')"> Close Ticket </button> 
                      </td>
                  </tr>
                  </table>
                  </form>
                </div> 
                
                    <span>
                          <td id="reject">
                            <button type="button" class="reject-button" onclick="reject();">Reject or Close Ticket</button>
                          </td>
                    </span>

                </div>
              
      </div>

<div id = 'logframe' class = "log">

<header><span  id="closeButton" class="closeboxlog" onclick="javascript:document.getElementById('logframe').style.display='none';"><img src="{% static '/images/back-btn-arrw.png' %}"></span>
  </header>
  <div class="popup-body" >
    <iframe id="frame1" style="display: none ;" name="frame1" class="log" scrolling ='yes'   frameborder="0">
    </iframe>
</div>
</div>


<div id = 'chat-div'  class="chat-frame" >
 <span  id="close-chat" class="chat-close"  onclick="javascript:document.getElementById('chat-div').style.display='none';document.getElementById('close-chat').style.display='none';"><img src="{% static '/images/back-btn-arrw.png' %}"></span>
   
 
  <iframe id="chat"  src="" name="chat" class="chat-frame"  width="50%" height="100%"  scrolling="no"  frameborder="0">
         </iframe>  
 
 </div>



{% if messages %}
    {% for message in messages %}
        <script>
            alert("{{ message }}"); 
        </script>

    {% endfor %}
   
{% endif %}

{% block script %}

<script>

document.getElementById('dashboard').classList.add('active');

 function getTicketCount(selectElement) {
    const selectedOption = selectElement.options[selectElement.selectedIndex];
    const ticketCount = selectedOption.getAttribute("data-ticket-count");
    // alert("Ticket Count:" + ticketCount + selectElement);

    // You can also update a hidden field, span, etc.
    document.getElementById("ticketCountDisplay").innerText = ticketCount;
  }

function remarkSelector(){
    /*This function is to get the values according to which div's style is block to reject() function to pass*/
    
    const divNames = ['devasgn','tstr_slct','dev_slct','dev_cht','tstr_qry','tckt_clse'];
    // Loop through the divs and find the one with display:block
        for (let i = 0; i < divNames.length; i++) {
            let div = document.getElementById(divNames[i]);
            if (div.style.display === 'block') {
                // Get the value of the textarea inside the visible div
                
                let divElement = document.getElementById(divNames[i]);
                let remarksValue = divElement.querySelector('#remarks');
                // alert(divNames[i] , "fd " , remarksValue.textContent)
                
                return(remarksValue);
											 
                break;  // Assuming only one div is visible at a time
            }
        }
    
}

function outlook() {
    var tid = document.getElementById('updtid').value;
    // alert(tid)
    var logsUrl = '/cadmin/logs/' + tid + '/';
    document.getElementById('frame1').src = logsUrl;
    document.getElementById('logframe').style.display = 'block';
    document.getElementById('frame1').style.display = 'block';
}

function chatfn(){
  event.stopPropagation();    // @sa 06/02/2025 changed when i clicked chat button it blibks
  var tid = document.getElementById('updtid').value.trim();
  // alert(tid)

    let chatContainer = document.getElementById('chaticon' + tid).parentElement;
    let notificationDot = chatContainer.querySelector('.notification-dot');

    if (notificationDot) {
        notificationDot.remove(); // Removes the span element
    }
  document.getElementById('chat').src = "{% url 'chtbx' 0 %}".replace('0', tid);
  if(document.getElementById('chat-div')!='block' ){
    document.getElementById('chat-div').style.display = 'block';
    document.getElementById('close-chat').style.display = 'block';
    document.getElementById('chat').style.display = 'block';
  }
}

function tstr_change() {
  alert('Tester changed');
  tno = document.getElementById('updtid').value;
  var remarks = document.getElementById('remarks').value.trim();if(remarks == '') { remarks = ' ';}
  var tstr = document.getElementById('tstr_drpdwn').value;
  var cf = confirm('Are you sure?');
  if(cf == true){
  var status = document.getElementById('tstatus'+tno).value.trim();
  var tester = document.getElementById('tstr_drpdwn').value;
  var status = document.getElementById('tstatus' + tno).value;
  if( status == 'PP'){ //for any query or bug report if tester raised that should be clarified
    const link = '/cadmin/tstr_ops/' + tno + '/' + status + '/' + tstr + '/' + remarks + '/' + 1 + '/' ;
    window.location.href = link
  
  }
}
}

function actionselect(tno){
    document.getElementById('retest').style.display = 'none';
    var tstat = 'tstatus'+ tno;
    document.getElementById('updtid').value = tno;
    tid = 'ttester'+tno; //TESTER ID
    var tdevid = document.getElementById('tdevid' + tno).value;
    var ttester = document.getElementById(tid).value.trim();
    var dropdown = testerslction(ttester);
    var devdrpdwn = devslction(tdevid);
    var status = document.getElementById(tstat).value.trim();
    // alert(status);
   if(status == 'TP' && tdevid == '' && ttester == ''){ // for new ticket
    
      var v = showticket(tno,'NT');
      showDiv('devasgn');
      // document.getElementById('devasgn').style.display = 'block';
      // document.getElementById('tstr_slct').style.display = 'none';

    }
    else if (status == 'TP' && tdevid != '' ){  // for developer query  && ttester == ''
      var v = showticket(tno,'DQ');
      // alert('second')
      document.getElementById('dev_cht_desc').innerHTML = 'Forward it to developer';
      document.getElementById('dev_drpdwn').style.display = 'none';
      showDiv('dev_cht');
      // document.getElementById('dev_cht').style.display = 'block';
    }


    else if (status == 'TA'  && tdevid != '' && ttester != '' ){ //maaaaaaaaaaaaaaark
      var v = showticket(tno);

    }

    else if (status == 'CR'  &&  tdevid != '' && ttester != '' ){  //user cancels live push
      var v = showticket(tno,'CR');
      var btn = document.getElementById('dev_cht_btn');
      document.getElementById('dev_cht_desc').innerHTML = 'Additional changes required ';

      btn.textContent = 'Re-assign';
      showDiv('dev_cht');

    }
    

    else if(status == 'EH' ){ 
    var v = showticket(tno,'EH'); // b refers username
    document.getElementById('tstr_label').innerHTML ='Select tester';
    var button = document.getElementById('tstr_btn');
    button.textContent='Assign';
  
    showDiv('tstr_slct');
    // document.getElementById('tstr_slct').style.display = 'block';
    // document.getElementById('devasgn').style.display = 'none';

    // document.getElementById('tstr_drpdwn_pp').style.display = 'none';
    }
  else if(status == 'PP'){
    var v = showticket(tno,'PP'); // b refers username
    var button = document.getElementById('tstr_btn');
    document.getElementById('retest').style.display = 'block';
    document.getElementById('tstr_label').innerHTML ='Reassign for testing';
    button.textContent='Forward to client';
    showDiv('tstr_slct');
    // document.getElementById('tstr_drpdwn').style.display = 'none';
    // document.getElementById('tstr_slct').style.display = 'block';
    // document.getElementById('tstr_drpdwn_pp').style.display = 'block';
    // var drpdwn_pp = document.getElementById('tstr_drpdwn_pp');
    // var tester = document.getElementById('tester').value;
    
    // drpdwn_pp.value = tester;
    // var event = new Event("change");
    // drpdwn_pp.dispatchEvent(event);

  }
  else if(status == 'RC'){
    var v = showticket(tno,'RC'); // b refers username
    // document.getElementById('tstr_drpdwn').style.display = 'none';
    document.getElementById('dev_slct').style.display = 'block';
    showDiv('dev_slct');
    var button = document.getElementById('dev_btn');
    button.textContent='Forward to copy';
  }
  // else{
    // var v =  showticket(tno,b);
  // }
  else if(status == 'DH'){
    var v = showticket(tno,'DH');
    var btn = document.getElementById('dev_cht_btn');
    document.getElementById('dev_cht_desc').innerHTML = 'Developer has requested a query to client in chat.';
    btn.textContent = 'Forward';
    showDiv('dev_cht');
    document.getElementById('dev_drpdwn').style.display = 'none';
    // document.getElementById('dev_cht').style.display = 'block';

  }


  else if(status == 'PC'){
    var v = showticket(tno,'PC');
    showDiv('tckt_clse');
    // document.getElementById('tckt_clse').style.display = 'block';
 

  }

  }

function assigndev(){
  dev_drpdwn = document.getElementById('devassign').value;
  ticket_id = document.getElementById('updtid').value;
  var form = document.getElementById('devasgn_form');
  var hiddenInput = document.createElement('input');
  hiddenInput.type = 'hidden';
  hiddenInput.name = 'updtid';
  hiddenInput.value = ticket_id;
  
  if (dev_drpdwn != "" ){
    var cf = confirm('Are you sure you want to assign this to ' + dev_drpdwn);
    if (cf == true){
      form.appendChild(hiddenInput);
      return true;
    }
    else{
      return false;
    }
  }
  else{
    alert('Please select a developer!');
    return false;
  }

}

function tstrops(flag){
  ticket_id = document.getElementById('updtid').value;
  var form = document.getElementById('tstr_slct_form');
  var hiddenInput = document.createElement('input');
  hiddenInput.type = 'hidden';
  hiddenInput.name = 'updtid';
  hiddenInput.value = ticket_id;

  var flag_var = document.createElement('input');
  flag_var.type = 'hidden';
  flag_var.name = 'flag';
  flag_var.value = flag;


  var remarks = document.getElementById('remarks').value;
  var cf = confirm('Are you sure?');
  if (cf ==  true){
    form.appendChild(hiddenInput);
    form.appendChild(flag_var);
    form.submit();
  }
  else{
    return false;
  }
}

function devops(form){
  ticket_id = document.getElementById('updtid').value; 
  var form_tag = document.getElementById(form);
															  
  // alert(form_tag)
  console.log(form_tag+'jinoy');
  var hiddenInput = document.createElement('input');
  hiddenInput.type = 'hidden';
  hiddenInput.name = 'updtid';
  hiddenInput.value = ticket_id;

															  
														
				 
   
  var cf = confirm('Are you sure about this action');

  if(cf == true){
    form_tag.appendChild(hiddenInput);
    form_tag.submit();
  }
  else{
    return false;
  }

  
}

document.addEventListener('keydown', function(event) {
    // Check if the pressed key is Enter
    if (event.key === 'Enter') {
      // Prevent the default action (form submission, new line in textarea, etc.)
      event.preventDefault();
    }
  });
  

// function tstrops(){ // tester related operations
//   tno = document.getElementById('updtid').value;
//   var remarks = document.getElementById('remarks').value.trim();if(remarks == '') { remarks = ' ';}
//   var cf = confirm('Are you sure?');
//   var status = document.getElementById('tstatus'+tno).value.trim();
//   var tester = document.getElementById('tstr_drpdwn').value;
//   var cur_tester = document.getElementById('cur_tstr_label_val').value;
//   // alert(cur_tester)
//   var status = document.getElementById('tstatus' + tno).value;
//   if(cf == true){
//   if( status == 'EA'){ //for any query or bug report if tester raised that should be clarified
//     alert('Tester : EA worked')
//     const link = '/cadmin/tstr_ops/' + tno + '/' + status + '/' + '' + '/' + remarks + '/' + 0 + '/'  ;
//     window.location.href = link
  
//   }
//   else {
//     // alert(status)
//     if(cur_tester != tester){
//     cf = confirm('Are you sure you want to change the tester ' + cur_tester + ' to ' + tester );
//     if(cf == true){
//       if( status = 'PP'){
//     const link = '/cadmin/tstr_ops/' + tno + '/' + status + '/' + tester + '/'  + remarks + '/' + 1 + '/' ;
//     window.location.href = link
//     }
//     else{
//       const link = '/cadmin/tstr_ops/' + tno + '/' + status + '/' + cur_tester + '/'  + remarks + '/' + 0 + '/' ;
//     window.location.href = link
//     }
//   }
//     else{ return false;}
//   }
//   else{

//     const link = '/cadmin/tstr_ops/' + tno + '/' + status + '/' + cur_tester + '/'  + remarks + '/' + 0 + '/' ;
//     window.location.href = link
//   }
// }
// }
// else{
//   return false;
// }
// }

// function usrops(){ // user related operations
//   tno = document.getElementById('updtid').value;
  
//   var status = document.getElementById('tstatus'+tno).value.trim();
//   var dev = document.getElementById('tstr_drpdwn').value;

//     const link = '/cadmin/usr_ops/' + tno + '/' + status + '/' + dev + '/' ;
//     window.location.href = link
  
// }


// function assigndev()
//   {
//     dev_drpdwn = document.getElementById('devassign').value;
//     if (dev_drpdwn != "" )
//     {
//       var cf = confirm('Are you sure you want to assign to ' + dev_drpdwn );
//       if(cf == true){
//     var remarks = document.getElementById('remarks').value;if(remarks == '') { remarks = ' ';}
//     // alert(remarks)
//     var devId = document.getElementById('devassign').value; //this is for intial TP when admin assigns aa developer
//     var ticket = document.getElementById('updtid').value;
//     var tstat = 'tstatus'+ ticket;
//     var status = document.getElementById(tstat).value.trim();
//     var devloper = document.getElementById('tdevid' + ticket).value; // this is for status TP when client rejct live forward
//      //alert(devId);
//     // return;
//     if ( status == 'TP' && devloper == ''){
//     const link = "/cadmin/assign_tckt/"+ ticket + "/" + devId + '/' + remarks + '/';
//     window.location.href = link;
//     }
//     }
//     else{
//       return false;
//     }
//   }
//   else{
//     alert('Please select a developer!');
//   }

//   }

// function acpt(){ // this changes status to PP
//   tno = document.getElementById('updtid').value;
//   const link = '/cadmin/tstradmnacpt/' + tno;
//   window.location.href = link ;
// }

function testerslction(tid){
  // alert(tid+'-tester')
  var dropdown = document.getElementById('tstr_drpdwn');
  for (var i = 0; i < dropdown.options.length; i++) {
            if (dropdown.options[i].value === tid) {
              dropdown.options[i].selected = true;
                document.getElementById('cur_tstr_label').innerHTML = dropdown.options[i].value;
                document.getElementById('cur_tstr_label_val').value = dropdown.options[i].value;
             // Remove the option at index i
            break; // Exit the loop once the desired option is found and removed
        }
                //break;  Exit the loop once the desired option is found
            }
        }


function devslction(tid){
  // alert(tid+'-tester')
  var dropdown = document.getElementById('dev_drpdwn');
  for (var i = 0; i < dropdown.options.length; i++) {
            if (dropdown.options[i].value === tid) {
                dropdown.options[i].selected = true;
                break; // Exit the loop once the desired option is found
            }
        }
}





// function  devops(){ // developer related operations
//   tno = document.getElementById('updtid').value;
//   var filler = ' ';
//   var cf = confirm('You are about to leave this page. Are you sure?');
//   var remarks = document.getElementById('remarks').value.trim(); if(remarks == '') { remarks = ' ';}
//   var status = document.getElementById('tstatus'+tno).value.trim();
//   //alert(status)
//   if(cf == true) {
//     if(status == 'EH'){
//     var dev = document.getElementById('tstr_drpdwn').value;

//       const link = '/cadmin/dev_ops/' + tno + '/' + status + '/' + dev + '/' + remarks + '/'  ;
//       window.location.href = link;
//     }
//     else if (status == 'PC'){
//       var dev = null;

//       const link = '/cadmin/dev_ops/' + tno + '/' + status + '/' + dev + '/'  + remarks + '/';
//       window.location.href = link;
//     }
//     else if(status == 'RC'){
//       var filler = null;
//       const link = '/cadmin/dev_ops/' + tno + '/' + status  + '/' + filler + '/'  + remarks + '/'; // filler for developer variable
//       window.location.href = link;
//     }
//     else if (status == 'DH'){
//       var dev  = document.getElementById('dev_drpdwn').value;
//       // alert(dev)
//       const link = '/cadmin/dev_ops/' + tno + '/' + status  + '/' + dev + '/'  + remarks  + '/'; // filler for developer variable
//       window.location.href = link;
//     }
//     else if (status == 'TP'){
//       var filler = null;
//       const link = '/cadmin/dev_ops/' + tno + '/' + status  + '/' + filler + '/'  + remarks + '/' ; // filler for developer variable
//       window.location.href = link;
//     }
//     else if ( status == 'CR'){
//       const link = '/cadmin/dev_ops/' + tno + '/' + status  + '/' + filler + '/'  + remarks + '/' ; // filler for developer variable
//       window.location.href = link;
//     }
//   }
//   else{
//     return false;
//   }
// }


/* This function is to close the ticket at any
moment of the ticket stage by Admin  */
function reject(){
  tno = document.getElementById('updtid').value.trim();
  
  rjct_reason = remarkSelector();
  // alert(rjct_reason.value + "j test")
  if(rjct_reason.value == ''){
    alert('Kindly add a rejection or closingremark in the comment section before proceeding.');
    return false
    // rjct_reason = '~'
    }
																  
  

  // alert(rjct_reason)


				 
 
  var cf = confirm("CAUTION : You are about to close this ticket .This can't be undone.");
  if (cf == true){
    const link = '/cadmin/adminclose/'+ tno + '/' + rjct_reason.value + '/';
    window.location.href = link;
  }
  else{
    return false;
  }
}

function queryclose(){
  var ticket_id = document.getElementById('updtid').value;
  // alert(ticket_id)
  var status = document.getElementById('tstatus' + ticket_id).value;
  // alert(status)
  var remarks = remarkSelector(); if(remarks == ''){remarks = '~'} // ~ used to refers null value of remark field
  var cf = confirm('Are you sure?');
  if(cf == true){
    if(status == 'DH'){
    link = '/cadmin/queryclose/'+ ticket_id + '/' + remarks + '/' ;
    window.location.href = link
    }
  }
  else{
    return false;
  }
}

 
 
function showticket(tno,stat){ // a param called chat was here like this showticket(tno,chat,stat)


  document.getElementById('chat-div').style.display='none';
  document.getElementById('close-chat').style.display='none';
  // alert(tdesc);
  document.getElementById("tcktpopup").style.display = "block";
  // document.getElementById("devasgn").style.display = "none";

  // $('#myBox').show();
  var tdesc = 'tdes'+ tno;
  var tsub = 'tsub'+tno; // subject
  var tpriority = 'tpriority'+tno; //priority
  var tcl = 'tcli' + tno; //Client
  var tfile = 'tfile' + tno;
  var status = 'tstatus' + tno;
  var issued = 'tissue' + tno;
  var maker =  'tmaker'+tno;
// document.getElementById("myBox").style.display="block";
  if( stat == 'NT'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : New ticket';
  }
  else if( stat == 'DQ'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Client closed clarification.';
  }
  else if( stat == 'EH'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Ready for testing';
  }
  else if( stat == 'CR'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Declined by user';
  }
  else if(stat == 'PP'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Ready for client testing';
  }
  else if(stat == 'RC'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Client Accepted.Ready for live';
  }
  else if(stat == 'DH'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Developer raised clarification request';
  }
  else if(stat == 'PC'){
    document.getElementById('wrdstat').innerHTML = 'STATUS : Program copied , waiting for closure.';
  }
  
  
  document.getElementById('ticket_no').innerHTML=":  " + tno; // ticket number
  document.getElementById('maker').innerHTML="  " + document.getElementById(maker).value; // user name
  document.getElementById('tsub').innerHTML="  " + document.getElementById(tsub).value; // ticket subject
  document.getElementById('tdesc').innerHTML= "  " + document.getElementById(tdesc).value; // ticket description
  document.getElementById('tdate').innerHTML = " " + document.getElementById(issued).value;
  var fileurl = document.getElementById(tfile).value;
  // alert(document.getElementById(tdesc).value);
  if(fileurl != 'none'){
  var fileurl = document.getElementById(tfile).value;
  var link =document.createElement('a'); 
  link.href = fileurl;
  link.target = '_blank';
  link.textContent = ' Click here to view file';
  // alert(link);
  
  document.getElementById('tfile').appendChild(link);
  }
  else{
    document.getElementById('tfile').innerHTML = ' No Files Attached.';
  }
  document.getElementById('tpri').innerHTML="  " + priority(tno) // ticket priority;
  document.getElementById('tcli').innerHTML="  " + document.getElementById(tcl).value; // ticket client
  if (status == 'DH'){

  }

}

function showDiv(divId) {
  // Get all elements with the class "child"
  var divs = document.querySelectorAll('.child');

  // Hide all divs
  for (var i = 0; i < divs.length; i++) {
    divs[i].style.display = 'none';
  }

  // Show the specified div
  var divToShow = document.getElementById(divId);
  if (divToShow) {
    divToShow.style.display = 'block'; // or 'inline', 'inline-block', 'flex', etc. depending on your layout
  }
}




// function testeracpt(tno,user){

//   document.getElementById("tacptbox").style.display = "block";

//   // $('#myBox').show();
//   var tdesc = 'tdes'+ tno;
//   var tsub = 'tsub'+tno; // subject
//   var tpriority = 'tpriority'+tno; //priority
//   var tcl = 'tcli' + tno; //Client

// // document.getElementById("myBox").style.display="block";

//   // alert(tdesc);
//   document.getElementById('updtid').value = tno;
//   document.getElementById('ticket_no').innerHTML=":  " + tno; // ticket number
//   document.getElementById('maker').innerHTML=":  " + user; // user name
//   document.getElementById('tsub').innerHTML=":  " + document.getElementById(tsub).value; // ticket subject
//   document.getElementById('tdesc').innerHTML= ":  " + document.getElementById(tdesc).value; // ticket description
//   // alert(document.getElementById(tdesc).value);
//   document.getElementById('tpri').innerHTML=":  " + document.getElementById(tpriority).value; // ticket priority
//   document.getElementById('tcli').innerHTML=":  " + document.getElementById(tcl).value; // ticket client

// }


  // Add an event listener to hide the 'myBox' when clicking outside of it
  // $(document).on('click', function(event) {
  //   if (!$(event.target).closest('#myBox').length) {
  //     var box = document.getElementById("myBox");
  //     box.style.display = "none";
  //   }
  // });
  

// exit symbol
function closeBox() {
  //document.getElementById("myBox").style.display = "none";
  //document.getElementById("tacptbox").style.display = "none";
  document.getElementById('tfile').innerHTML =null;
  document.getElementById("tcktpopup").style.display = "none";
  var rmks = document.getElementById('remarks').value='';

    
}
function clearPopup(){
  document.getElementById('tfile').innerHTML =null;

}

function clearDivValues() {
    
}

// for chat div @sa 06/02/2025
document.addEventListener("click", function(event) {
           var notificationMenu = document.getElementById("chat-div");
            var button = document.getElementById(event.target.id);
            //console.log('ydytitfytfyrr')
            // Check if click is outside the menu and the button

            if(event.target.id!='chatbt' && event.target.id!='chatsp'){
                  //notificationMenu.classList.remove("open-menu");
                  if(document.getElementById('chat-div').style.display=='block'){
                   document.getElementById('chat-div').style.display = 'none';
            }
            }
        });


</script>

{%endblock%}

{%endblock%}