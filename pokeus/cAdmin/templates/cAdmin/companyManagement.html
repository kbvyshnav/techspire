{% extends "cAdmin/baseUI.html" %}
{% load static %}
{% block body %}
{% load countries %}
<style>

.box {
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 background-color:  #f2f2f2;
 border-radius: 20px;
 box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
 padding: 20px;
 width: 1000px;
 height: 500px;
}


.inner-box{
background-color: white;
padding: 20px;
 width: 957px;
 height: 462px;

}


.exit-symbol {
 position: absolute;
 top: 24px;
 right: 44px;
 font-size: 30px;
 cursor: pointer;
}
.btn {
    appearance: none;
      -webkit-appearance: none;
    font-family:poppins, sans-serif;
    cursor: pointer;
    min-width: 35px;
    border: 0px;
      -webkit-transition: background-color 100ms linear;
      -ms-transition: background-color 100ms linear;
       transition: background-color 100ms linear;
    float: Right;
    border-radius: 10px;
    {% comment %} box-shadow: 5px 5px 5px 1px grey; {% endcomment %}
  }
  
  .btn:focus, .btn.focus {
    outline: 0;
  }



.view {
  width: 40px;
  background-color: transparent;
  color:blue;
  font-size:15px;

}


.users {
  background-color: transparent;
  color:blue;
  font-size:15px;
  padding:0px;
}

{% comment %} .users:hover {
  background: #2d5e5e;
  color: #ffffff;
} {% endcomment %}

.edit {
  float:left;
  color:black;
  font-size:15px;
  padding-left:15px;
  padding-right:15px;
  box-shadow:3px 3px 3px 1px grey;
  height:30px;
  text-align:top;

}

{% comment %} .edit:hover {
 background: #069ff8;
 color: #ffffff;
} {% endcomment %}
.settings {
  background-color: transparent;
  color:blue;
  font-size:15px;
  width: 35px;
  border-radius: 25px;
    padding:0px;

}

/*.settings:hover {
  background: #069ff8;
  color: #ffffff;*/

body 
{
counter-reset: Serial;  /* Set the Serial counter to 0 */
}


tr td:first-child:before
{
counter-increment: Serial;
content:  counter(Serial) " ."; 
}

.add-company-btn{
  text-align: center;
  background: #800080;
  color:white;
  padding: 8px;
  outline:none;
  font-family: poppins, sans-serif;
  cursor:pointer;
  border:none;
  transition: background 0.3s ease;
  box-shadow:3px 3px 3px 1px grey; 
}

.add-company-btn:hover {
  background: #cc99cc; 
}

.btn.users {
  text-align: center;
  color: #800080;
  padding: 5px;
  outline: none;
  font-family: Poppins, sans-serif; 
  cursor: pointer;
  border: none;
  background: #F9F9F9; 
}

.btn.users:hover {
   background: #cc99cc; 
}

.btn.settings img {
  display: block;
  margin: auto;
  width: 50%;  
}

.btn.settings:hover img {
  background: #cc99cc; /* Change the background on hover */
  border-radius: 20px; /* Include padding in the element's total width and height */
  transform: scale(1.1); /* Increase the size on hover */
}


</style>


<div class="table-data">
    <div class="order">
        <div class="head" >
            <h4 style="color: purple;font-size:1.2rem; ">COMPANIES</h4>
            
             <a href ="{% url 'add_company' %}" >
                    
                    <button class="add-company-btn">Add Company</button>
            </a>
              
        </div>
         <table id="table-datas">
            <thead>
                
                <tr>
                    <th>Company Name</th>
                    <th>Country</th>
                    <th>Contact</th>
                    <th>Email</th>
                    <th></th>
                    <!-- <th>Date Of Expiry</th>
                    <th>View Ticket</th> -->
                    
                    
                </tr>
                
            </thead>
            <tbody>
                {% for lst in cmpnylist %}
                <tr><td> {{lst.companyName}}</td>
                
                <td title="{{lst.companyCntry.name }}" > {{lst.companyCntry.alpha3 }}</td>
                <td> {{lst.companyCntct}}</td>
                <td> {{lst.companyMail}}</td>

                <td><button type="button" class="btn users" onclick="window.location.href='{% url 'user_management' lst.companyId %}'"
                  id="{{lst.companyId}}">
                
                &nbsp;Manage Users</td>

                <td><button type="button"  class="btn view" value="{{lst.companyAddr}}" id="{{lst.companyId}}">
                <i class='bx bx-list-ul' >&nbsp;</i>
                </td>
                <td>
                    <button type="button" class="btn settings" onclick="settings(this.id)" id="{{ lst.companyId }}" title="Settings">
                      <img src="{% static 'images/settings-icon.png' %}" alt="settings-logo">
                    </button>
                </td>
                </td>
                </tr> 
                          
        
                <!-- exit symbol -->
              
              <div class="box" id="myBox" style="display: none;">                    
                  <div class="inner-box">
                      <span class="exit-symbol" onclick="closeBox()">&times;</span>
                      <p style="color: purple;font-size:1.2rem; "><b>OTHER DETAILS </b></p>
                      <hr>
                      <p id="address"></p>
                       <p id="address"></p>
                        <p id="address"></p>
                         <p id="address"></p>                      
                  </div>
              </div> 
              
                    </tbody>
            {% empty %}
              <th id="thstyle" style="border:none; float: right; margin-top:80px; font-size: large;"><b> No companies created yet!</b></th>            
            {% endfor %}  
                
                </table></div>
</div>
{% if messages %}
    {% for message in messages %}
        <script>
            alert("{{ message }}");
        </script>
    {% endfor %}
{% endif %}



{% block script %}
<script>
document.getElementById('companymanagement').classList.add('active');
document.getElementById('main-head').style.display ='none';

const viewButtons = document.querySelectorAll('.view');
const box = document.getElementById('myBox');
const addressElement = document.getElementById('address');

// Add event listeners to each "View Details" button
viewButtons.forEach((button) => {
  button.addEventListener('click', (event) => {
    const address = button.value;
    const cmpnyId = button.id;
    const editUrl = "/cadmin/companyedit/" + cmpnyId + "/";
    const anchorTag = document.createElement("a");
    anchorTag.href = editUrl;
    const editButton = document.createElement("button");                               
    editButton.type = "button";
    editButton.className = "btn edit";
    editButton.innerText = "Edit";
    anchorTag.appendChild(editButton);
    addressElement.innerHTML = '<table> <tbody  style="padding: 4px; text-align:left; width:50px; height:100px; overflow:auto ;"></br><b>Address: &nbsp; &nbsp; &nbsp;</b>' + address + ' \
    </tbody></table>';
    addressElement.appendChild(anchorTag);

    box.style.display = 'block';
  });
});

function redirectToUserView(id) {
  var url = "/cadmin/usermanagement/" + id + "/";
  window.location.href = url;
}

function settings(id) {
  var url = "/cadmin/companysettings/" + id + "/";
  window.location.href = url;
}

document.addEventListener('click', (event) => {
  const isClickInside = box.contains(event.target);
  const isViewButtonClick = Array.from(viewButtons).some((button) => button.contains(event.target));

  if (!isClickInside && !isViewButtonClick) {
    box.style.display = 'none';
  }
});

box.addEventListener('click', (event) => {
  event.stopPropagation();
});

// exit symbol
function closeBox() {
 var box = document.getElementById("myBox");
 box.style.display = "none";
}


  function goBack() {
    window.history.back();
  }


</script>
{% endblock %}
{%endblock%}